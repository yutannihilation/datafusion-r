# Generated by savvy: do not edit by hand
#
# Note:
#   This wrapper file is named as `000-wrappers.R` so that this file is loaded
#   first, which allows users to override the functions defined here (e.g., a
#   print() method for an enum).

#' @useDynLib datafusionr, .registration = TRUE
#' @keywords internal
NULL

# Check class and extract the external pointer embedded in the environment
.savvy_extract_ptr <- function(e, class) {
  if(inherits(e, class)) {
    e$.ptr
  } else {
    msg <- paste0("Expected ", class, ", got ", class(e)[1])
    stop(msg, call. = FALSE)
  }
}


### wrapper functions for RDataFrame

RDataFrame_print <- function(self) {
  function() {
  invisible(.Call(savvy_RDataFrame_print__impl, self))
  }
}

RDataFrame_limit <- function(self) {
  function(n, offset) {
    .savvy_wrap_RDataFrame(.Call(savvy_RDataFrame_limit__impl, self, n, offset))
  }
}

RDataFrame_select_columns <- function(self) {
  function(columns) {
    .savvy_wrap_RDataFrame(.Call(savvy_RDataFrame_select_columns__impl, self, columns))
  }
}

RDataFrame_select <- function(self) {
  function(expr) {
    expr <- .savvy_extract_ptr(expr, "RExpr")
  .savvy_wrap_RDataFrame(.Call(savvy_RDataFrame_select__impl, self, expr))
  }
}

.savvy_wrap_RDataFrame <- function(ptr) {
  e <- new.env(parent = emptyenv())
  e$.ptr <- ptr
    e$print <- RDataFrame_print(ptr)
  e$limit <- RDataFrame_limit(ptr)
  e$select_columns <- RDataFrame_select_columns(ptr)
  e$select <- RDataFrame_select(ptr)
  
  class(e) <- "RDataFrame"
  e
}



RDataFrame <- new.env(parent = emptyenv())

### associated functions for RDataFrame



### wrapper functions for RExpr

RExpr_print <- function(self) {
  function() {
  invisible(.Call(savvy_RExpr_print__impl, self))
  }
}

RExpr_add <- function(self) {
  function(rhs) {
    rhs <- .savvy_extract_ptr(rhs, "RExpr")
  .savvy_wrap_RExpr(.Call(savvy_RExpr_add__impl, self, rhs))
  }
}

RExpr_sub <- function(self) {
  function(rhs) {
    rhs <- .savvy_extract_ptr(rhs, "RExpr")
  .savvy_wrap_RExpr(.Call(savvy_RExpr_sub__impl, self, rhs))
  }
}

RExpr_mul <- function(self) {
  function(rhs) {
    rhs <- .savvy_extract_ptr(rhs, "RExpr")
  .savvy_wrap_RExpr(.Call(savvy_RExpr_mul__impl, self, rhs))
  }
}

RExpr_div <- function(self) {
  function(rhs) {
    rhs <- .savvy_extract_ptr(rhs, "RExpr")
  .savvy_wrap_RExpr(.Call(savvy_RExpr_div__impl, self, rhs))
  }
}

RExpr_alias <- function(self) {
  function(name) {
    .savvy_wrap_RExpr(.Call(savvy_RExpr_alias__impl, self, name))
  }
}

.savvy_wrap_RExpr <- function(ptr) {
  e <- new.env(parent = emptyenv())
  e$.ptr <- ptr
    e$print <- RExpr_print(ptr)
  e$add <- RExpr_add(ptr)
  e$sub <- RExpr_sub(ptr)
  e$mul <- RExpr_mul(ptr)
  e$div <- RExpr_div(ptr)
  e$alias <- RExpr_alias(ptr)
  
  class(e) <- "RExpr"
  e
}



RExpr <- new.env(parent = emptyenv())

### associated functions for RExpr

RExpr$col <- function(x) {
  .savvy_wrap_RExpr(.Call(savvy_RExpr_col__impl, x))
}


### wrapper functions for RSessionContext

RSessionContext_create_data_frame <- function(self) {
  function(raw_stream, table_name) {
    raw_stream <- .savvy_extract_ptr(raw_stream, "RawArrayStream")
  .savvy_wrap_RDataFrame(.Call(savvy_RSessionContext_create_data_frame__impl, self, raw_stream, table_name))
  }
}

.savvy_wrap_RSessionContext <- function(ptr) {
  e <- new.env(parent = emptyenv())
  e$.ptr <- ptr
    e$create_data_frame <- RSessionContext_create_data_frame(ptr)
  
  class(e) <- "RSessionContext"
  e
}



RSessionContext <- new.env(parent = emptyenv())

### associated functions for RSessionContext

RSessionContext$new <- function() {
  .savvy_wrap_RSessionContext(.Call(savvy_RSessionContext_new__impl))
}


### wrapper functions for RawArrayStream


.savvy_wrap_RawArrayStream <- function(ptr) {
  e <- new.env(parent = emptyenv())
  e$.ptr <- ptr
  
  
  class(e) <- "RawArrayStream"
  e
}



RawArrayStream <- new.env(parent = emptyenv())

### associated functions for RawArrayStream

RawArrayStream$new_without_init <- function() {
  .savvy_wrap_RawArrayStream(.Call(savvy_RawArrayStream_new_without_init__impl))
}


